title: "AI Solutions - Translation Application"
stackDescription: Deploy AI Translation Application with Authentication with OCI IAM via Resource Manager Stack
description: "Deploy AI Translation Application with Authentication with OCI IAM via Resource Manager Stack"
schemaVersion: 1.1.0
version: "20190404"
locale: "en"

variableGroups:
  - title: Hide constants and internal variables
    visible: false
    variables:
      - tenancy_ocid
      - compartment_ocid
      - current_user_ocid
      - region
      - shape
      - model_backend
      - model_name
      - model_url
      - openai_api_key
      - translation_log_dir
      - num_workers
      - vcn_display_name
      - multimodal_model_name
      - deployment_type
      - deployment_bandwidth_mbps
      - deployment_instance_count
      - model_backend
      - model_name
      - model_url
      - oci_cache_endpoint
      - openai_api_key
      - translation_log_dir
      - num_workers

  - title: "General Configuration"
    variables:
      - compartment_id
      - availability_domain
  - title: "Network"
    variables:
      - create_new_vcn
      - existing_vcn_id
      - vcn_cidr
      - existing_app_subnet_id
      - app_subnet_cidr
      - existing_api_gw_subnet_id
      - api_gw_subnet_cidr
  - title: "Authentication Configuration"
    variables:
      - identity_domain_id
      - use_existing_vault
      - new_vault_display_name
      - vault_id
      - key_id
  - title: "Application Container Instance Configurations"
    variables:
      - container_shape
      - memory_in_gbs
      - ocpus

variables:
  # General Configuration
  compartment_id:
    type: oci:identity:compartment:id
    required: true
    title: Compartment Id
    description: The compartment in which to create all the resources.
    default: compartment_ocid
  availability_domain:
    type: oci:identity:availabilitydomain:name
    required: true
    title: Availability domain
    description: The availability domain in which to create all Compute Instance resources.
    dependsOn:
      compartmentId: ${compartment_id}
  #Network Configuration
  create_new_vcn:
    type: boolean
    required: true
    title: Create New VCN, Subnet, NAT Gateway, Internet Gateway, etc. for the application
    default: true
  existing_vcn_id:
    type: oci:core:vcn:id
    required: true
    title: Select to VCN
    visible:
      not:
        - create_new_vcn
    dependsOn:
      compartmentId: ${compartment_id}
  vcn_cidr:
    type: string
    required: true
    title: VCN IPv4 CIDR Blocks
    description: This VCN will be used for all resources created by the stack.
    default: "10.1.0.0/16"
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    visible: create_new_vcn
  existing_app_subnet_id:
    type: oci:core:subnet:id
    required: true
    title: Select the application subnet
    dependsOn:
      compartmentId: ${compartment_id}
      vcnId: ${existing_vcn_id}
      hidePublicSubnet: true
    visible:
      not:
        - create_new_vcn
  app_subnet_cidr:
    type: string
    required: true
    title: Application Subnet IPv4 CIDR Blocks
    description: The container instances running the application will be created in this subnet.
    default: "10.1.1.0/24"
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    visible: create_new_vcn
  existing_api_gw_subnet_id:
    type: oci:core:subnet:id
    required: true
    title: Select the API Gateway subnet
    dependsOn:
      compartmentId: ${compartment_id}
      vcnId: ${existing_vcn_id}
      hidePublicSubnet: false
    visible:
      not:
        - create_new_vcn
  api_gw_subnet_cidr:
    type: string
    required: true
    title: API Gateway Subnet IPv4 CIDR Blocks
    description: API Gateway will be created in this subnet.
    pattern: "^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]).(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\\/(3[0-2]|[1-2]?[0-9])$"
    default: "10.1.2.0/24"
    visible: create_new_vcn
  #Application Configuration
  identity_domain_id:
   type: oci:identity:domains:id
   required: true
   title: Identity domain
   description: Identity Domain in which confidential integrated application needs to be created
   visible: true
   dependsOn:
    compartmentId: ${compartment_id}
  # Vault Configuration
  use_existing_vault:
    type: boolean
    title: Use an existing key vault
    required: true
    default: true
    description: This vault will be used to store client secret of identity application used by API Gateway for Authentication.
  new_vault_display_name:
    type: string
    title: Key vault display name
    description: A user-friendly name to help you easily identify the resource.
    required: true
    visible:
      not:
        - use_existing_vault
  vault_id:
    type: oci:kms:vault:id
    required: true
    title: Vault
    description: Choose an existing vault used to store the client secret.
    dependsOn:
      compartmentId: ${compartment_id}
    visible:
      and:
        - use_existing_vault
  key_id:
    type: oci:kms:key:id
    required: true
    title: Encryption key
    description: This key will be used to encrypt the sensitive information stored as vault secrets.
    dependsOn:
      compartmentId: ${compartment_id}
      vaultId: ${vault_id}
    visible:
      and:
        - use_existing_vault
    # Container instances configuration
  container_shape:
    type: enum
    required: true
    title: Container instance shape
    description: A shape is a template that determines the number of OCPUs, amount of memory, and other resources that are allocated to a container instance.
    default: "CI.Standard.E4.Flex"
    enum:
      - CI.Standard.E3.Flex
      - CI.Standard.E4.Flex
  memory_in_gbs:
    type: number
    required: true
    title: Memory (GB)
    default: 16
    minimum: 1
    maximum: 1024
    description: Min - 1 GB or a value matching the number of OCPUs, whichever is greater. Max - 64 GB per OCPU, up to 1024 GB total
  ocpus:
    type: number
    required: true
    title: OCPU
    description: Min - 1 OCPU. Max - 64 OCPU
    default: 1
    minimum: 1
    maximum: 64

outputGroups:
  - title: "Application URL"
    outputs:
      - app_url

outputs:
  app_url:
    type: link
    title: "Playground UI URL"
    visible: true

  
